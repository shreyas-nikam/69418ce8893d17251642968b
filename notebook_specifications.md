
```jupyter
{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# The PE Org-AI-R Readiness Simulator: Quantifying AI Potential in Private Equity\n",
    "\n",
    "## Executive Summary\n",
    "\n",
    "As a **Portfolio Manager** or **Quantitative Analyst** at a Private Equity firm, you are constantly evaluating target companies for acquisition or monitoring the performance of existing portfolio companies. In today's market, **AI readiness** is a critical, yet often qualitative, driver of value creation and competitive advantage. This Jupyter Notebook provides a structured, quantitative framework – the **PE Org-AI-R Score** – to systematically assess a company's AI maturity and potential.\n",
    "\n",
    "This tool allows you to:\n",
    "\n",
    "1.  **Rapidly Screen** target companies by inputting key characteristics and behavioral ratings.\n",
    "2.  **Quantify AI Readiness** across organizational capabilities (Idiosyncratic Readiness) and industry potential (Systematic Opportunity).\n",
    "3.  **Identify Gaps** against industry benchmarks to pinpoint areas for strategic investment.\n",
    "4.  **Perform Scenario and Sensitivity Analysis** to understand how different strategic choices or underlying factors impact a company's AI potential and overall valuation.\n",
    "5.  **Assess Exit-Readiness** to build compelling, evidence-based narratives for future buyers.\n",
    "\n",
    "By following this real-world workflow, you will gain actionable insights that directly inform deal evaluation, value creation planning, and portfolio optimization, transforming AI from an aspirational concept into a measurable, auditable value lever."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1. Setup: Installing Libraries and Importing Dependencies\n",
    "\n",
    "Before we begin our assessment, we need to ensure all necessary libraries are installed and imported. These libraries will help us with data manipulation, numerical operations, and creating informative visualizations to support our analysis."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Install required libraries (uncomment and run if not already installed)\n",
    "# !pip install pandas numpy matplotlib seaborn tabulate\n",
    "\n",
    "# Import required dependencies\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "from tabulate import tabulate\n",
    "\n",
    "print(\"Libraries installed and imported successfully!\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. Defining the PE Org-AI-R Framework: Core Components and Parameters\n",
    "\n",
    "As a Quantitative Analyst, understanding the underlying structure of the PE Org-AI-R framework is crucial. This section defines the constants and parameters that drive our AI readiness assessment. We'll set up predefined `Systematic Opportunity` scores for various industries, `default dimension weights`, and `sector-specific adjustments` based on the provided research. These parameters allow us to contextualize a company's AI potential within its industry landscape.\n",
    "\n",
    "The core `PE Org-AI-R Score` is defined by the formula:\n",
    "\n",
    "$$PE Org-AI-R = \\alpha \\cdot IdiosyncraticReadiness + (1 - \\alpha) \\cdot SystematicOpportunity + \\beta \\cdot Synergy$$\n",
    "\n",
    "Where:\n",
    "- $IdiosyncraticReadiness$: Organization-specific AI capabilities, a weighted aggregate of seven dimensions, normalized to a 0-100 scale.\n",
    "- $SystematicOpportunity$: Industry-level AI potential, normalized to a 0-100 scale.\n",
    "- $Synergy$: Represents the combined benefit of idiosyncratic readiness and systematic opportunity, a conceptual score on a 0-100 scale.\n",
    "- $\\alpha \\in [0, 1]$: Weight on organizational factors vs. market factors (prior: $\\alpha \\in [0.55, 0.70]$).\n",
    "- $\\beta \\ge 0$: Synergy coefficient (prior: $\\beta \\in [0.08, 0.25]$).\n",
    "\n",
    "Each dimension score contributing to `IdiosyncraticReadiness` is calculated from behavioral ratings (1-5 scale) using the formula described in Phase 4 of Due Diligence:\n",
    "\n",
    "$$D_k = \\left( \\frac{\\sum_i w_i \\cdot Rating_{i,k}}{5} \\right) \\times 100$$\n",
    "\n",
    "Where:\n",
    "- $D_k$: The converted score for dimension $k$ (0-100).\n",
    "- $w_i$: The weight for dimension $i$.\n",
    "- $Rating_{i,k}$: The raw behavioral rating (1-5) for dimension $i$ for company in industry $k$.\n",
    "- The sum of weights $\\sum w_i = 1$. This formula effectively maps a 1-5 raw rating scale to a 20-100 index, assuming the sum of weights is 1."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define the seven dimensions for Idiosyncratic Readiness\n",
    "DIMENSIONS = [\n",
    "    \"Data Infrastructure\",\n",
    "    \"AI Governance\",\n",
    "    \"Technology Stack\",\n",
    "    \"Talent\",\n",
    "    \"Leadership\",\n",
    "    \"Use Case Portfolio\",\n",
    "    \"Culture\",\n",
    "]\n",
    "\n",
    "# Predefined Systematic Opportunity scores (0-100) for different industries\n",
    "SYSTEMATIC_OPPORTUNITY = {\n",
    "    \"Manufacturing\": 72,\n",
    "    \"Healthcare\": 78,\n",
    "    \"Retail\": 75,\n",
    "    \"Business Services\": 80,\n",
    "    \"Technology\": 85,\n",
    "}\n",
    "\n",
    "# Default dimension weights (sum to 1)\n",
    "DEFAULT_DIMENSION_WEIGHTS = {\n",
    "    \"Data Infrastructure\": 0.25,\n",
    "    \"AI Governance\": 0.20,\n",
    "    \"Technology Stack\": 0.15,\n",
    "    \"Talent\": 0.15,\n",
    "    \"Leadership\": 0.10,\n",
    "    \"Use Case Portfolio\": 0.10,\n",
    "    \"Culture\": 0.05,\n",
    "}\n",
    "\n",
    "# Sector-specific dimension weight adjustments\n",
    "SECTOR_SPECIFIC_WEIGHTS = {\n",
    "    \"Manufacturing\": {\n",
    "        \"Data Infrastructure\": 0.28, \"AI Governance\": 0.15, \"Technology Stack\": 0.18,\n",
    "        \"Talent\": 0.15, \"Leadership\": 0.08, \"Use Case Portfolio\": 0.12, \"Culture\": 0.04,\n",
    "    },\n",
    "    \"Healthcare\": {\n",
    "        \"Data Infrastructure\": 0.28, \"AI Governance\": 0.25, \"Technology Stack\": 0.12,\n",
    "        \"Talent\": 0.15, \"Leadership\": 0.08, \"Use Case Portfolio\": 0.08, \"Culture\": 0.04,\n",
    "    },\n",
    "    \"Retail\": {\n",
    "        \"Data Infrastructure\": 0.28, \"AI Governance\": 0.12, \"Technology Stack\": 0.18,\n",
    "        \"Talent\": 0.14, \"Leadership\": 0.10, \"Use Case Portfolio\": 0.13, \"Culture\": 0.05,\n",
    "    },\n",
    "    \"Business Services\": {\n",
    "        \"Data Infrastructure\": 0.22, \"AI Governance\": 0.18, \"Technology Stack\": 0.15,\n",
    "        \"Talent\": 0.20, \"Leadership\": 0.10, \"Use Case Portfolio\": 0.10, \"Culture\": 0.05,\n",
    "    },\n",
    "    \"Technology\": {\n",
    "        \"Data Infrastructure\": 0.22, \"AI Governance\": 0.15, \"Technology Stack\": 0.20,\n",
    "        \"Talent\": 0.22, \"Leadership\": 0.08, \"Use Case Portfolio\": 0.10, \"Culture\": 0.03,\n",
    "    },\n",
    "}\n",
    "\n",
    "# Example Industry Benchmark Scores (75th percentile) for gap analysis (0-100 scale)\n",
    "INDUSTRY_BENCHMARKS = {\n",
    "    \"Manufacturing\": {\n",
    "        \"Data Infrastructure\": 60, \"AI Governance\": 55, \"Technology Stack\": 60,\n",
    "        \"Talent\": 58, \"Leadership\": 70, \"Use Case Portfolio\": 50, \"Culture\": 60,\n",
    "    },\n",
    "    \"Healthcare\": {\n",
    "        \"Data Infrastructure\": 65, \"AI Governance\": 70, \"Technology Stack\": 55,\n",
    "        \"Talent\": 60, \"Leadership\": 65, \"Use Case Portfolio\": 52, \"Culture\": 58,\n",
    "    },\n",
    "    \"Retail\": {\n",
    "        \"Data Infrastructure\": 62, \"AI Governance\": 50, \"Technology Stack\": 65,\n",
    "        \"Talent\": 57, \"Leadership\": 68, \"Use Case Portfolio\": 55, \"Culture\": 60,\n",
    "    },\n",
    "    \"Business Services\": {\n",
    "        \"Data Infrastructure\": 68, \"AI Governance\": 65, \"Technology Stack\": 65,\n",
    "        \"Talent\": 70, \"Leadership\": 72, \"Use Case Portfolio\": 60, \"Culture\": 62,\n",
    "    },\n",
    "    \"Technology\": {\n",
    "        \"Data Infrastructure\": 70, \"AI Governance\": 60, \"Technology Stack\": 75,\n",
    "        \"Talent\": 75, \"Leadership\": 70, \"Use Case Portfolio\": 68, \"Culture\": 65,\n",
    "    },\n",
    "}\n",
    "\n",
    "def convert_rating_to_index(raw_rating: int) -> float:\n",
    "    \"\"\"\n",
    "    Converts a raw behavioral rating (1-5 scale) to a 0-100 index score.\n",
    "    As per paper's D_k formula (sum(w_i * Rating_i,k) / 5) * 100, assuming sum(w_i)=1.\n",
    "    A 1-5 rating range maps to a 20-100 index range directly.\n",
    "    \"\"\"\n",
    "    if not 1 <= raw_rating <= 5:\n",
    "        raise ValueError(\"Raw rating must be between 1 and 5.\")\n",
    "    # Scale 1-5 directly to 20-100 (1 -> 20, 5 -> 100)\n",
    "    return (raw_rating / 5) * 100\n",
    "\n",
    "\n",
    "def calculate_idiosyncratic_readiness(\n",
    "    dimension_ratings: dict[str, int],\n",
    "    industry: str,\n",
    "    use_sector_weights: bool = True,\n",
    ") -> tuple[float, pd.Series]:\n",
    "    \"\"\"\n",
    "    Calculates the Idiosyncratic Readiness score for a company.\n",
    "    Converts 1-5 ratings to 0-100 index and applies weighted aggregation.\n",
    "\n",
    "    Args:\n",
    "        dimension_ratings (dict): Dictionary of dimension names to their raw 1-5 ratings.\n",
    "        industry (str): The industry of the target company.\n",
    "        use_sector_weights (bool): Whether to use sector-specific weights or default weights.\n",
    "\n",
    "    Returns:\n",
    "        tuple[float, pd.Series]: The overall Idiosyncratic Readiness score (0-100) and\n",
    "                                 a Series of individual dimension scores (0-100).\n",
    "    \"\"\"\n",
    "    if use_sector_weights and industry in SECTOR_SPECIFIC_WEIGHTS:\n",
    "        weights = SECTOR_SPECIFIC_WEIGHTS[industry]\n",
    "    else:\n",
    "        weights = DEFAULT_DIMENSION_WEIGHTS\n",
    "\n",
    "    weighted_sum = 0\n",
    "    dimension_scores = {}\n",
    "    for dim, rating in dimension_ratings.items():\n",
    "        if dim not in weights:\n",
    "            raise ValueError(f\"Dimension '{dim}' not found in weights.\")\n",
    "        scaled_rating = convert_rating_to_index(rating)\n",
    "        dimension_scores[dim] = scaled_rating\n",
    "        weighted_sum += weights[dim] * scaled_rating\n",
    "\n",
    "    # The overall Idiosyncratic Readiness is the weighted sum of scaled (0-100) dimension scores.\n",
    "    # Since individual scaled_rating already maps 1-5 to 20-100 and weights sum to 1,\n",
    "    # the weighted_sum will naturally be in the 20-100 range.\n",
    "    return weighted_sum, pd.Series(dimension_scores)\n",
    "\n",
    "print(\"Framework parameters and functions defined.\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3. Assessing a Target Company: Inputs for Idiosyncratic Readiness and Systematic Opportunity\n",
    "\n",
    "As a **Portfolio Manager**, your first step in evaluating a new target company is to gather crucial information. We will simulate this process by defining a hypothetical company's characteristics, including its `industry`, `raw behavioral ratings` (1-5 scale) across the seven `Idiosyncratic Readiness` dimensions, and a `Synergy score`. This direct input reflects the initial due diligence data you would collect.\n",
    "\n",
    "For this example, let's consider a **Manufacturing** company we are evaluating."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# --- User Inputs for Target Company --- \n",
    "target_company_industry = \"Manufacturing\"\n",
    "\n",
    "# Raw behavioral ratings (1-5 scale) for each dimension\n",
    "# These would typically come from expert assessments during due diligence.\n",
    "target_dimension_ratings = {\n",
    "    \"Data Infrastructure\": 3,\n",
    "    \"AI Governance\": 2,\n",
    "    \"Technology Stack\": 3,\n",
    "    \"Talent\": 2,\n",
    "    \"Leadership\": 4,\n",
    "    \"Use Case Portfolio\": 1,\n",
    "    \"Culture\": 3,\n",
    "}\n",
    "\n",
    "# Conceptual Synergy score (0-100)\n",
    "# This represents the perceived combined benefit of the company's capabilities and market opportunity.\n",
    "target_synergy_score = 65\n",
    "\n",
    "# Framework parameters (alpha, beta) can be adjusted to reflect PE firm's priorities\n",
    "# Alpha: Weight on Idiosyncratic Readiness vs. Systematic Opportunity (0.55-0.70 is typical)\n",
    "# Beta: Synergy coefficient (0.08-0.25 is typical)\n",
    "alpha_param = 0.65  # We put more weight on organizational capabilities\n",
    "beta_param = 0.15   # Moderate synergy impact\n",
    "\n",
    "# --- Calculation --- \n",
    "\n",
    "# Get Systematic Opportunity based on industry\n",
    "systematic_opportunity_score = SYSTEMATIC_OPPORTUNITY.get(\n",
    "    target_company_industry, 0\n",
    ")\n",
    "\n",
    "# Calculate Idiosyncratic Readiness using sector-specific weights\n",
    "idiosyncratic_readiness_score, dimension_scores_df = calculate_idiosyncratic_readiness(\n",
    "    target_dimension_ratings, target_company_industry, use_sector_weights=True\n",
    ")\n",
    "\n",
    "print(f\"Target Company Industry: {target_company_industry}\")\n",
    "print(f\"Raw Dimension Ratings: {target_dimension_ratings}\")\n",
    "print(f\"Systematic Opportunity Score: {systematic_opportunity_score:.2f}\")\n",
    "print(f\"Calculated Idiosyncratic Readiness Score: {idiosyncratic_readiness_score:.2f}\")\n",
    "print(f\"Synergy Score: {target_synergy_score:.2f}\")\n",
    "print(f\"Alpha (organizational weight): {alpha_param:.2f}\")\n",
    "print(f\"Beta (synergy coefficient): {beta_param:.2f}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 4. Calculating the PE Org-AI-R Score: A Holistic View of AI Readiness\n",
    "\n",
    "With the individual components defined, we can now calculate the overall `PE Org-AI-R Score`. This score provides a single, quantitative metric that summarizes the company's AI readiness, integrating its internal capabilities (`Idiosyncratic Readiness`), external market potential (`Systematic Opportunity`), and perceived `Synergy` between these factors. As a Portfolio Manager, this is your go-to metric for initial assessment and comparison. As a Quantitative Analyst, you can now see the aggregated result of all the defined parameters.\n",
    "\n",
    "The calculation follows the primary formula:\n",
    "\n",
    "$$PE Org-AI-R = \\alpha \\cdot IdiosyncraticReadiness + (1 - \\alpha) \\cdot SystematicOpportunity + \\beta \\cdot Synergy$$\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def calculate_pe_org_ai_r_score(\n",
    "    idiosyncratic_readiness: float,\n",
    "    systematic_opportunity: float,\n",
    "    synergy: float,\n",
    "    alpha: float,\n",
    "    beta: float,\n",
    ") -> float:\n",
    "    \"\"\"\n",
    "    Calculates the overall PE Org-AI-R Score.\n",
    "\n",
    "    Args:\n",
    "        idiosyncratic_readiness (float): Company's Idiosyncratic Readiness score (0-100).\n",
    "        systematic_opportunity (float): Industry's Systematic Opportunity score (0-100).\n",
    "        synergy (float): Conceptual Synergy score (0-100).\n",
    "        alpha (float): Weight for Idiosyncratic Readiness.\n",
    "        beta (float): Synergy coefficient.\n",
    "\n",
    "    Returns:\n",
    "        float: The calculated PE Org-AI-R Score.\n",
    "    \"\"\"\n",
    "    pe_org_ai_r = (\n",
    "        alpha * idiosyncratic_readiness\n",
    "        + (1 - alpha) * systematic_opportunity\n",
    "        + beta * synergy\n",
    "    )\n",
    "    return pe_org_ai_r\n",
    "\n",
    "# Execute the calculation for our target company\n",
    "overall_pe_org_ai_r_score = calculate_pe_org_ai_r_score(\n",
    "    idiosyncratic_readiness_score,\n",
    "    systematic_opportunity_score,\n",
    "    target_synergy_score,\n",
    "    alpha_param,\n",
    "    beta_param,\n",
    ")\n",
    "\n",
    "print(f\"The calculated PE Org-AI-R Score for the {target_company_industry} company is: \"\n",
    "      f\"{overall_pe_org_ai_r_score:.2f}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Interpretation of the PE Org-AI-R Score\n",
    "\n",
    "For a **Portfolio Manager**, this single score provides a quick snapshot of the company's overall AI readiness. A higher score indicates stronger AI capabilities and greater potential for AI-driven value creation. This score can be compared against other targets in your pipeline or portfolio, aiding in initial prioritization and resource allocation discussions.\n",
    "\n",
    "For a **Quantitative Analyst**, this confirms the model's aggregation of the various inputs and weights. It serves as the baseline for further, more granular analysis, such as identifying specific areas for improvement or conducting sensitivity tests."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 5. Idiosyncratic Readiness Breakdown and Gap Analysis\n",
    "\n",
    "While the overall `PE Org-AI-R Score` is valuable, a **Portfolio Manager** needs to understand the underlying drivers. This section focuses on the `Idiosyncratic Readiness` dimensions, breaking down the company's performance and comparing it against `industry benchmarks` (e.g., 75th percentile). This `Gap Analysis` helps pinpoint specific strengths and weaknesses, guiding strategic interventions and value creation plans.\n",
    "\n",
    "The `Gap` for each dimension $k$ is calculated as:\n",
    "\n",
    "$$Gap_k = D_k^{target} - D_k^{current}$$\n",
    "\n",
    "Where:\n",
    "- $D_k^{target}$: The target (benchmark) score for dimension $k$.\n",
    "- $D_k^{current}$: The current (company's) score for dimension $k$. A positive gap indicates an area where the company is lagging the benchmark."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def perform_gap_analysis(\n",
    "    company_dimension_scores: pd.Series,\n",
    "    industry: str,\n",
    ") -> pd.DataFrame:\n",
    "    \"\"\"\n",
    "    Compares company dimension scores against industry benchmarks and calculates gaps.\n",
    "\n",
    "    Args:\n",
    "        company_dimension_scores (pd.Series): Series of the company's 0-100 dimension scores.\n",
    "        industry (str): The industry of the company.\n",
    "\n",
    "    Returns:\n",
    "        pd.DataFrame: A DataFrame showing company scores, benchmark scores, and gaps.\n",
    "    \"\"\"\n",
    "    if industry not in INDUSTRY_BENCHMARKS:\n",
    "        print(f\"Warning: No specific benchmarks for {industry}. Using general benchmarks (simulated).\")\n",
    "        # Fallback for industries without specific benchmarks (for demo purposes)\n",
    "        benchmark_scores = pd.Series({\n",
    "            dim: 65 for dim in DIMENSIONS\n",
    "        }, name=\"Benchmark Score\")\n",
    "    else:\n",
    "        benchmark_scores = pd.Series(\n",
    "            INDUSTRY_BENCHMARKS[industry], name=\"Benchmark Score\"\n",
    "        )\n",
    "\n",
    "    analysis_df = pd.DataFrame(\n",
    "        {\n",
    "            \"Company Score\": company_dimension_scores,\n",
    "            \"Benchmark Score\": benchmark_scores,\n",
    "        }\n",
    "    )\n",
    "    analysis_df[\"Gap (Benchmark - Company)\"] = analysis_df[\"Benchmark Score\"] - analysis_df[\"Company Score\"]\n",
    "    return analysis_df.sort_values(by=\"Gap (Benchmark - Company)\", ascending=False)\n",
    "\n",
    "\n",
    "# Perform gap analysis for the target company\n",
    "gap_analysis_df = perform_gap_analysis(dimension_scores_df, target_company_industry)\n",
    "\n",
    "print(\"\\n--- Idiosyncratic Readiness Dimension Scores and Gap Analysis ---\")\n",
    "print(tabulate(gap_analysis_df, headers='keys', tablefmt='pipe'))\n",
    "\n",
    "# Visualization: Idiosyncratic Readiness Breakdown (Radar Chart)\n",
    "fig, ax = plt.subplots(figsize=(8, 8), subplot_kw=dict(polar=True))\n",
    "categories = list(dimension_scores_df.index)\n",
    "values = dimension_scores_df.values\n",
    "num_vars = len(categories)\n",
    "angles = np.linspace(0, 2 * np.pi, num_vars, endpoint=False).tolist()\n",
    "values = np.concatenate((values, [values[0]]))\n",
    "angles = np.concatenate((angles, [angles[0]]))\n",
    "\n",
    "ax.plot(angles, values, linewidth=2, linestyle='solid', label='Company Score')\n",
    "ax.fill(angles, values, 'blue', alpha=0.25)\n",
    "\n",
    "benchmark_values = pd.Series(INDUSTRY_BENCHMARKS[target_company_industry]).loc[categories].values\n",
    "benchmark_values = np.concatenate((benchmark_values, [benchmark_values[0]]))\n",
    "ax.plot(angles, benchmark_values, linewidth=2, linestyle='dashed', color='red', label='Industry Benchmark')\n",
    "\n",
    "ax.set_theta_offset(np.pi / 2)\n",
    "ax.set_theta_direction(-1)\n",
    "ax.set_rlabel_position(0)  # Move r-labels away from chart\n",
    "ax.set_xticks(angles[:-1])\n",
    "ax.set_xticklabels(categories, fontsize=10)\n",
    "ax.set_ylim(0, 100)\n",
    "ax.set_yticks([20, 40, 60, 80, 100])\n",
    "ax.set_yticklabels([\"20\", \"40\", \"60\", \"80\", \"100\"], color=\"grey\", size=8)\n",
    "ax.set_title(\"Idiosyncratic Readiness Breakdown vs. Industry Benchmark\", size=14, color='navy', y=1.1)\n",
    "ax.legend(loc='upper right', bbox_to_anchor=(1.3, 1.1))\n",
    "plt.show()\n",
    "\n",
    "# Visualization: Gap Analysis (Bar Chart)\n",
    "plt.figure(figsize=(10, 6))\n",
    "sns.barplot(x=gap_analysis_df.index, y=\"Gap (Benchmark - Company)\", data=gap_analysis_df, palette='viridis')\n",
    "plt.axhline(0, color='grey', linewidth=0.8)\n",
    "plt.title(\"Gap Analysis: Priority Areas for AI Capability Improvement\", fontsize=14, color='navy')\n",
    "plt.xlabel(\"AI Readiness Dimension\", fontsize=12)\n",
    "plt.ylabel(\"Gap to Industry Benchmark (Score Points)\", fontsize=12)\n",
    "plt.xticks(rotation=45, ha='right', fontsize=10)\n",
    "plt.grid(axis='y', linestyle='--', alpha=0.7)\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Interpretation of Idiosyncratic Readiness Breakdown and Gap Analysis\n",
    "\n",
    "For the **Portfolio Manager**, the radar chart immediately highlights the company's profile across the seven dimensions, allowing for a visual comparison against industry peers. The bar chart clearly indicates which dimensions have the largest gaps, serving as **priority areas for investment** and strategic focus in the 100-day plan and beyond. For instance, a large gap in 'Data Infrastructure' suggests foundational work is needed before advanced AI initiatives can succeed.\n",
    "\n",
    "For the **Quantitative Analyst**, this detailed breakdown validates the individual dimension scoring and shows how the company's internal capabilities stack up. It provides concrete data points for deeper dives into the specific sub-components of each dimension, informing more precise recommendations for improvement."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6. Simulating Scenarios: Planning for Best-Case, Base-Case, and Worst-Case AI Readiness\n",
    "\n",
    "As a **Portfolio Manager**, you need to understand the potential range of outcomes for your investment. `Scenario Analysis` allows you to evaluate how the `PE Org-AI-R Score` would change under different assumptions about the company's future performance or during various stages of due diligence (e.g., initial optimistic screening vs. post-diligence conservative view). This helps in risk assessment and setting realistic improvement targets.\n",
    "\n",
    "We will define three scenarios: `Best-Case`, `Base-Case`, and `Worst-Case`, by adjusting the input dimension ratings and synergy scores. The overall Org-AI-R score will be calculated for each scenario."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def run_scenario_analysis(\n",
    "    industry: str,\n",
    "    base_ratings: dict[str, int],\n",
    "    base_synergy: float,\n",
    "    alpha: float,\n",
    "    beta: float,\n",
    ") -> pd.DataFrame:\n",
    "    \"\"\"\n",
    "    Calculates PE Org-AI-R scores for best-case, base-case, and worst-case scenarios.\n",
    "\n",
    "    Args:\n",
    "        industry (str): The industry of the target company.\n",
    "        base_ratings (dict): Base-case raw 1-5 dimension ratings.\n",
    "        base_synergy (float): Base-case synergy score (0-100).\n",
    "        alpha (float): Weight for Idiosyncratic Readiness.\n",
    "        beta (float): Synergy coefficient.\n",
    "\n",
    "    Returns:\n",
    "        pd.DataFrame: DataFrame containing Org-AI-R scores for each scenario.\n",
    "    \"\"\"\n",
    "    scenarios = {\n",
    "        \"Worst-Case\": {\n",
    "            \"dimension_mod\": -1,  # -1 point from base rating, min 1\n",
    "            \"synergy_mod\": -20,  # -20 points from base synergy, min 0\n",
    "        },\n",
    "        \"Base-Case\": {\"dimension_mod\": 0, \"synergy_mod\": 0},\n",
    "        \"Best-Case\": {\n",
    "            \"dimension_mod\": 1,  # +1 point from base rating, max 5\n",
    "            \"synergy_mod\": 20,  # +20 points from base synergy, max 100\n",
    "        },\n",
    "    }\n",
    "\n",
    "    results = []\n",
    "    for scenario_name, mods in scenarios.items():\n",
    "        scenario_ratings = { \n",
    "            dim: max(1, min(5, rating + mods[\"dimension_mod\"])) \n",
    "            for dim, rating in base_ratings.items()\n",
    "        }\n",
    "        scenario_synergy = max(0, min(100, base_synergy + mods[\"synergy_mod\"])) \n",
    "\n",
    "        so_score = SYSTEMATIC_OPPORTUNITY.get(industry, 0)\n",
    "        ir_score, _ = calculate_idiosyncratic_readiness(scenario_ratings, industry, True)\n",
    "        org_ai_r = calculate_pe_org_ai_r_score(ir_score, so_score, scenario_synergy, alpha, beta)\n",
    "        results.append({\n",
    "            \"Scenario\": scenario_name,\n",
    "            \"Org-AI-R Score\": org_ai_r,\n",
    "            \"Idiosyncratic Readiness\": ir_score,\n",
    "            \"Synergy\": scenario_synergy,\n",
    "        })\n",
    "\n",
    "    return pd.DataFrame(results).set_index(\"Scenario\")\n",
    "\n",
    "\n",
    "# Execute scenario analysis\n",
    "scenario_df = run_scenario_analysis(\n",
    "    target_company_industry,\n",
    "    target_dimension_ratings,\n",
    "    target_synergy_score,\n",
    "    alpha_param,\n",
    "    beta_param,\n",
    ")\n",
    "\n",
    "print(\"\\n--- Scenario Analysis Results (PE Org-AI-R Score) ---\")\n",
    "print(tabulate(scenario_df, headers='keys', tablefmt='pipe', floatfmt=\".2f\"))\n",
    "\n",
    "# Visualization: Scenario Analysis (Bar Chart)\n",
    "plt.figure(figsize=(8, 5))\n",
    "sns.barplot(x=scenario_df.index, y=\"Org-AI-R Score\", data=scenario_df, palette='cividis')\n",
    "plt.title(\"PE Org-AI-R Score Across Scenarios\", fontsize=14, color='navy')\n",
    "plt.xlabel(\"Scenario\", fontsize=12)\n",
    "plt.ylabel(\"PE Org-AI-R Score\", fontsize=12)\n",
    "plt.ylim(0, 100)\n",
    "plt.grid(axis='y', linestyle='--', alpha=0.7)\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Interpretation of Scenario Analysis\n",
    "\n",
    "For the **Portfolio Manager**, this analysis quantifies the upside potential and downside risk associated with the company's AI readiness. It helps in formulating conservative and aggressive investment theses and in understanding the sensitivity of the overall score to changes in underlying capabilities. This insight is critical for deal negotiation and for setting ambitious but achievable targets for portfolio companies.\n",
    "\n",
    "For the **Quantitative Analyst**, this demonstrates the model's response to input variations, providing a preliminary sense of its robustness. It's a foundational step before more rigorous sensitivity testing, showing how the model behaves under different operational conditions."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 7. Evaluating Exit Potential: The Exit-AI-R Score\n",
    "\n",
    "When preparing a portfolio company for exit, demonstrating embedded AI capabilities is paramount for attracting strategic buyers and achieving valuation premiums. As a **Portfolio Manager**, you need a dedicated metric to assess how well a company's AI story will resonate with potential acquirers. The `Exit-AI-R Score` provides this lens, focusing on factors that directly influence buyer perception and valuation.\n",
    "\n",
    "The `Exit-AI-R Score` is defined by the formula:\n",
    "\n",
    "$$Exit-AI-R = w_1 \\cdot Visible + w_2 \\cdot Documented + w_3 \\cdot Sustainable$$\n",
    "\n",
    "Where:\n",
    "- $Visible$: AI capabilities apparent to buyers (product features, technology stack), a conceptual input (0-100).\n",
    "- $Documented$: Quantified AI impact with an audit trail, a conceptual input (0-100).\n",
    "- $Sustainable$: Embedded capabilities vs. one-time projects, a conceptual input (0-100).\n",
    "- $w_1 = 0.35$ (Visible: first impressions matter).\n",
    "- $w_2 = 0.40$ (Documented: buyers need proof).\n",
    "- $w_3 = 0.25$ (Sustainable: ongoing value vs. run-rate risk)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# --- User Inputs for Exit-Readiness Factors (0-100 scale) --- \n",
    "exit_visible_score = 70      # e.g., prominent AI features, modern tech stack\n",
    "exit_documented_score = 60   # e.g., some ROI tracking, case studies available\n",
    "exit_sustainable_score = 55  # e.g., capabilities are partly embedded, some key talent retained\n",
    "\n",
    "# Fixed weights for Exit-AI-R Score\n",
    "exit_w1 = 0.35  # Visible\n",
    "exit_w2 = 0.40  # Documented\n",
    "exit_w3 = 0.25  # Sustainable\n",
    "\n",
    "def calculate_exit_ai_r_score(\n",
    "    visible: float,\n",
    "    documented: float,\n",
    "    sustainable: float,\n",
    "    w1: float = 0.35,\n",
    "    w2: float = 0.40,\n",
    "    w3: float = 0.25,\n",
    ") -> float:\n",
    "    \"\"\"\n",
    "    Calculates the Exit-AI-R Score for a portfolio company.\n",
    "\n",
    "    Args:\n",
    "        visible (float): AI capabilities apparent to buyers (0-100).\n",
    "        documented (float): Quantified AI impact with audit trail (0-100).\n",
    "        sustainable (float): Embedded capabilities vs. one-time projects (0-100).\n",
    "        w1, w2, w3 (float): Weights for Visible, Documented, and Sustainable, respectively.\n",
    "\n",
    "    Returns:\n",
    "        float: The calculated Exit-AI-R Score.\n",
    "    \"\"\"\n",
    "    if not np.isclose(w1 + w2 + w3, 1.0):\n",
    "        raise ValueError(\"Exit-AI-R weights must sum to 1.0\")\n",
    "    \n",
    "    exit_ai_r = w1 * visible + w2 * documented + w3 * sustainable\n",
    "    return exit_ai_r\n",
    "\n",
    "\n",
    "# Execute the calculation\n",
    "exit_ai_r_score = calculate_exit_ai_r_score(\n",
    "    exit_visible_score, exit_documented_score, exit_sustainable_score, exit_w1, exit_w2, exit_w3\n",
    ")\n",
    "\n",
    "print(\"\\n--- Exit-Readiness Score Assessment ---\")\n",
    "print(f\"Visible AI Capabilities: {exit_visible_score:.2f}\")\n",
    "print(f\"Documented AI Impact: {exit_documented_score:.2f}\")\n",
    "print(f\"Sustainable AI Capabilities: {exit_sustainable_score:.2f}\")\n",
    "print(f\"Calculated Exit-AI-R Score: {exit_ai_r_score:.2f}\")\n",
    "\n",
    "# Visualization: Exit-AI-R Breakdown\n",
    "exit_data = pd.DataFrame({\n",
    "    'Factor': ['Visible', 'Documented', 'Sustainable'],\n",
    "    'Score': [exit_visible_score, exit_documented_score, exit_sustainable_score],\n",
    "    'Weight': [exit_w1, exit_w2, exit_w3],\n",
    "    'Weighted Score': [exit_w1 * exit_visible_score, exit_w2 * exit_documented_score, exit_w3 * exit_sustainable_score]\n",
    "})\n",
    "\n",
    "plt.figure(figsize=(9, 6))\n",
    "sns.barplot(x='Factor', y='Score', data=exit_data, palette='coolwarm')\n",
    "plt.title('Exit-AI-R Factors Breakdown', fontsize=14, color='navy')\n",
    "plt.xlabel('Exit Readiness Factor', fontsize=12)\n",
    "plt.ylabel('Score (0-100)', fontsize=12)\n",
    "plt.ylim(0, 100)\n",
    "plt.grid(axis='y', linestyle='--', alpha=0.7)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "plt.figure(figsize=(7, 7))\n",
    "plt.pie(exit_data['Weighted Score'], labels=exit_data['Factor'], autopct='%1.1f%%',\n",
    "        startangle=90, colors=sns.color_palette('coolwarm'),\n",
    "        wedgeprops={'edgecolor': 'black'})\n",
    "plt.title(f'Contribution to Total Exit-AI-R Score ({exit_ai_r_score:.2f})', fontsize=14, color='navy')\n",
    "plt.axis('equal') # Equal aspect ratio ensures the pie chart is circular.\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Interpretation of the Exit-AI-R Score\n",
    "\n",
    "For the **Portfolio Manager**, the `Exit-AI-R Score` highlights how robust the company's AI narrative is from a buyer's perspective. A low score in `Documented` might signal a need to focus on quantifying ROI from existing AI initiatives, while a low `Sustainable` score could indicate a reliance on single projects rather than integrated capabilities. This metric is a direct input into building a compelling exit story and can influence the target valuation multiple.\n",
    "\n",
    "For the **Quantitative Analyst**, this score introduces another layer of assessment, emphasizing different facets of AI maturity relevant for external valuation. It shows how specific weights prioritize aspects important to acquirers, demonstrating a tailored approach beyond internal operational readiness."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 8. Sensitivity Analysis: Understanding Key Value Drivers\n",
    "\n",
    "As a **Quantitative Analyst**, it's crucial to understand how robust the `PE Org-AI-R Score` is to changes in its underlying inputs. `Sensitivity Analysis` helps identify which dimensions or parameters have the greatest impact on the overall score. This insight is invaluable for a **Portfolio Manager** to prioritize investment areas that yield the highest return in terms of AI readiness improvement.\n",
    "\n",
    "We will assess the sensitivity of the `PE Org-AI-R Score` to a $\\pm 1$ point change in each of the raw `Idiosyncratic Readiness` dimension ratings and a $\\pm 10$ point change in the `Synergy` score. The `Systematic Opportunity` is considered constant for a given industry."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def perform_sensitivity_analysis(\n",
    "    base_ratings: dict[str, int],\n",
    "    base_synergy: float,\n",
    "    industry: str,\n",
    "    alpha: float,\n",
    "    beta: float,\n",
    ") -> pd.DataFrame:\n",
    "    \"\"\"\n",
    "    Performs sensitivity analysis by varying individual dimension ratings and synergy score.\n",
    "\n",
    "    Args:\n",
    "        base_ratings (dict): Base-case raw 1-5 dimension ratings.\n",
    "        base_synergy (float): Base-case synergy score (0-100).\n",
    "        industry (str): The industry of the target company.\n",
    "        alpha (float): Weight for Idiosyncratic Readiness.\n",
    "        beta (float): Synergy coefficient.\n",
    "\n",
    "    Returns:\n",
    "        pd.DataFrame: DataFrame showing the impact of variations on the Org-AI-R Score.\n",
    "    \"\"\"\n",
    "    so_score = SYSTEMATIC_OPPORTUNITY.get(industry, 0)\n",
    "    base_ir_score, _ = calculate_idiosyncratic_readiness(base_ratings, industry, True)\n",
    "    base_org_ai_r = calculate_pe_org_ai_r_score(base_ir_score, so_score, base_synergy, alpha, beta)\n",
    "\n",
    "    sensitivity_results = []\n",
    "\n",
    "    # Sensitivity to Idiosyncratic Readiness dimensions (+1 point raw rating)\n",
    "    for dim in DIMENSIONS:\n",
    "        test_ratings_up = base_ratings.copy()\n",
    "        test_ratings_up[dim] = min(5, base_ratings[dim] + 1) # Increase by 1, cap at 5\n",
    "        ir_up, _ = calculate_idiosyncratic_readiness(test_ratings_up, industry, True)\n",
    "        org_ai_r_up = calculate_pe_org_ai_r_score(ir_up, so_score, base_synergy, alpha, beta)\n",
    "        sensitivity_results.append({\n",
    "            \"Factor\": f\"IR: {dim} (+1 Raw Pt)\",\n",
    "            \"Impact on Org-AI-R\": org_ai_r_up - base_org_ai_r,\n",
    "        })\n",
    "\n",
    "    # Sensitivity to Idiosyncratic Readiness dimensions (-1 point raw rating)\n",
    "    for dim in DIMENSIONS:\n",
    "        test_ratings_down = base_ratings.copy()\n",
    "        test_ratings_down[dim] = max(1, base_ratings[dim] - 1) # Decrease by 1, cap at 1\n",
    "        ir_down, _ = calculate_idiosyncratic_readiness(test_ratings_down, industry, True)\n",
    "        org_ai_r_down = calculate_pe_org_ai_r_score(ir_down, so_score, base_synergy, alpha, beta)\n",
    "        sensitivity_results.append({\n",
    "            \"Factor\": f\"IR: {dim} (-1 Raw Pt)\",\n",
    "            \"Impact on Org-AI-R\": org_ai_r_down - base_org_ai_r,\n",
    "        })\n",
    "\n",
    "    # Sensitivity to Synergy Score (+10 points)\n",
    "    synergy_up = min(100, base_synergy + 10)\n",
    "    org_ai_r_synergy_up = calculate_pe_org_ai_r_score(base_ir_score, so_score, synergy_up, alpha, beta)\n",
    "    sensitivity_results.append({\n",
    "        \"Factor\": \"Synergy (+10 Pts)\",\n",
    "        \"Impact on Org-AI-R\": org_ai_r_synergy_up - base_org_ai_r,\n",
    "    })\n",
    "\n",
    "    # Sensitivity to Synergy Score (-10 points)\n",
    "    synergy_down = max(0, base_synergy - 10)\n",
    "    org_ai_r_synergy_down = calculate_pe_org_ai_r_score(base_ir_score, so_score, synergy_down, alpha, beta)\n",
    "    sensitivity_results.append({\n",
    "        \"Factor\": \"Synergy (-10 Pts)\",\n",
    "        \"Impact on Org-AI-R\": org_ai_r_synergy_down - base_org_ai_r,\n",
    "    })\n",
    "\n",
    "    return pd.DataFrame(sensitivity_results).sort_values(by=\"Impact on Org-AI-R\", ascending=False)\n",
    "\n",
    "\n",
    "# Execute sensitivity analysis\n",
    "sensitivity_df = perform_sensitivity_analysis(\n",
    "    target_dimension_ratings,\n",
    "    target_synergy_score,\n",
    "    target_company_industry,\n",
    "    alpha_param,\n",
    "    beta_param,\n",
    ")\n",
    "\n",
    "print(\"\\n--- Sensitivity Analysis Results (Impact on Org-AI-R Score) ---\")\n",
    "print(tabulate(sensitivity_df, headers='keys', tablefmt='pipe', floatfmt=\".2f\"))\n",
    "\n",
    "# Visualization: Sensitivity Analysis (Tornado Chart)\n",
    "plt.figure(figsize=(12, 8))\n",
    "sns.barplot(x=\"Impact on Org-AI-R\", y=\"Factor\", data=sensitivity_df, palette='viridis')\n",
    "plt.axvline(0, color='grey', linewidth=0.8)\n",
    "plt.title(\"Sensitivity of PE Org-AI-R Score to Input Changes\", fontsize=14, color='navy')\n",
    "plt.xlabel(\"Change in PE Org-AI-R Score\", fontsize=12)\n",
    "plt.ylabel(\"Input Factor Variation\", fontsize=12)\n",
    "plt.grid(axis='x', linestyle='--', alpha=0.7)\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Interpretation of Sensitivity Analysis\n",
    "\n",
    "For the **Portfolio Manager**, this tornado chart is extremely powerful. It visually highlights which AI capability dimensions, if improved, would have the most significant positive impact on the overall `Org-AI-R Score`. This allows for a data-driven prioritization of value creation initiatives, focusing resources where they will yield the greatest measurable improvement in AI readiness. It also shows the downside risk if certain areas deteriorate.\n",
    "\n",
    "For the **Quantitative Analyst**, this analysis provides a clear understanding of the model's key drivers and potential points of leverage. It quantifies the influence of each input, helping to refine the model, understand its robustness, and communicate its mechanics to non-technical stakeholders effectively."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Conclusion\n",
    "\n",
    "This Jupyter Notebook has guided you through a practical, quantitative workflow for assessing a company's AI readiness, a critical task for any Private Equity professional. By simulating the evaluation of a target company, you've seen how to:\n",
    "\n",
    "1.  **Systematically input company characteristics** and apply sector-specific weights.\n",
    "2.  **Calculate the comprehensive PE Org-AI-R Score** using defined framework parameters.\n",
    "3.  **Conduct a detailed gap analysis** to identify specific areas for AI capability improvement.\n",
    "4.  **Perform scenario analysis** to understand the range of potential AI readiness outcomes.\n",
    "5.  **Evaluate exit potential** through the `Exit-AI-R Score`, focusing on buyer-relevant metrics.\n",
    "6.  **Uncover key value drivers** through sensitivity analysis, informing strategic investment priorities.\n",
    "\n",
    "This framework transforms abstract AI potential into a measurable, actionable lever for deal evaluation, value creation, and successful exits. By integrating these quantitative insights into your workflow, you, as a **Portfolio Manager** or **Quantitative Analyst**, are better equipped to make informed decisions that drive superior returns in an AI-driven economy."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
```
